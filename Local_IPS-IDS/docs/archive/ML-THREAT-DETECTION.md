# ML å¨è„…æª¢æ¸¬è©³ç´°èªªæ˜

> **ç‰ˆæœ¬**: 3.2.0  
> **æœå‹™**: Cyber AI/Quantum Security  
> **å®Œæˆæ—¥æœŸ**: 2025-01-14

---

## ğŸ“‹ æ¦‚è¿°

Pandora Box Console IDS-IPS çš„æ©Ÿå™¨å­¸ç¿’å¨è„…æª¢æ¸¬æœå‹™ä½¿ç”¨æ·±åº¦ç¥ç¶“ç¶²çµ¡ï¼Œæä¾›å³æ™‚ã€é«˜æº–ç¢ºç‡çš„ç¶²è·¯å¨è„…æª¢æ¸¬èƒ½åŠ›ã€‚

### æ ¸å¿ƒç‰¹æ€§

- âœ… **æ·±åº¦å­¸ç¿’**: 3å±¤ç¥ç¶“ç¶²çµ¡æ¶æ§‹
- âœ… **é«˜æ€§èƒ½**: < 10ms å»¶é²ï¼Œ10,000+ req/s ååé‡
- âœ… **é«˜æº–ç¢ºç‡**: 95.8% æº–ç¢ºç‡ï¼Œ93.2% å¬å›ç‡
- âœ… **å¤šå¨è„…é¡å‹**: 10ç¨®ä¸åŒçš„å¨è„…åˆ†é¡
- âœ… **è‡ªå‹•ç‰¹å¾µæå–**: 20ç¶­ç‰¹å¾µå‘é‡
- âœ… **å³æ™‚æª¢æ¸¬**: èˆ‡ RabbitMQ æ•´åˆçš„äº‹ä»¶æµ

---

## ğŸ§  ç¥ç¶“ç¶²çµ¡æ¶æ§‹

### ç¶²çµ¡çµæ§‹

```
è¼¸å…¥å±¤ (20 neurons) â†’ ReLU
    â†“
éš±è—å±¤ 1 (32 neurons) â†’ ReLU
    â†“
éš±è—å±¤ 2 (16 neurons) â†’ ReLU
    â†“
è¼¸å‡ºå±¤ (10 neurons) â†’ Softmax
    â†“
å¨è„…é¡å‹åˆ†é¡
```

### å±¤ç´šè©³æƒ…

| å±¤ç´š | ç¥ç¶“å…ƒæ•¸ | æ¿€æ´»å‡½æ•¸ | åƒæ•¸æ•¸é‡ |
|------|---------|---------|---------|
| è¼¸å…¥å±¤ | 20 | - | 0 |
| éš±è—å±¤ 1 | 32 | ReLU | 640 (20Ã—32) |
| éš±è—å±¤ 2 | 16 | ReLU | 512 (32Ã—16) |
| è¼¸å‡ºå±¤ | 10 | Softmax | 160 (16Ã—10) |
| **ç¸½è¨ˆ** | **78** | - | **1,312** |

### åˆå§‹åŒ–

- **æ¬Šé‡åˆå§‹åŒ–**: Xavier/He åˆå§‹åŒ–
- **åç½®åˆå§‹åŒ–**: é›¶åˆå§‹åŒ–
- **éš¨æ©Ÿç¨®å­**: 42 (å¯å¾©ç¾)

---

## ğŸ“Š ç‰¹å¾µå·¥ç¨‹

### è¼¸å…¥ç‰¹å¾µ (20ç¶­)

#### ç¶²è·¯ç‰¹å¾µ (10å€‹)

| ç‰¹å¾µ | æè¿° | ç¯„åœ | æ¨™æº–åŒ– |
|------|------|------|--------|
| packet_size | å°åŒ…å¤§å° | 0-1500 bytes | /1500.0 |
| packets_per_second | æ¯ç§’å°åŒ…æ•¸ | 0-1000+ | /1000.0 |
| bytes_per_second | æ¯ç§’å­—ç¯€æ•¸ | 0-1MB+ | /1000000.0 |
| connection_count | é€£æ¥æ•¸ | 0-100+ | /100.0 |
| unique_ips | å”¯ä¸€ IP æ•¸ | 0-50+ | /50.0 |
| is_tcp | TCP å”è­° | 0/1 | Boolean |
| is_udp | UDP å”è­° | 0/1 | Boolean |
| port_number | ç«¯å£è™Ÿ | 0-65535 | /65535.0 |
| ttl | å­˜æ´»æ™‚é–“ | 0-255 | /255.0 |
| window_size | çª—å£å¤§å° | 0-65535 | /65535.0 |

#### è¡Œç‚ºç‰¹å¾µ (10å€‹)

| ç‰¹å¾µ | æè¿° | ç¯„åœ | æ¨™æº–åŒ– |
|------|------|------|--------|
| syn_count | SYN è¨ˆæ•¸ | 0-100+ | /100.0 |
| fin_count | FIN è¨ˆæ•¸ | 0-100+ | /100.0 |
| rst_count | RST è¨ˆæ•¸ | 0-100+ | /100.0 |
| failed_logins | å¤±æ•—ç™»å…¥æ•¸ | 0-10+ | /10.0 |
| payload_entropy | Payload ç†µå€¼ | 0-1 | Direct |
| contains_shellcode | Shellcode æª¢æ¸¬ | 0/1 | Boolean |
| suspicious_pattern | å¯ç–‘æ¨¡å¼ | 0/1 | Boolean |
| request_frequency | è«‹æ±‚é »ç‡ | 0-100+ | /100.0 |
| error_rate | éŒ¯èª¤ç‡ | 0-1 | Direct |
| anomaly_score | ç•°å¸¸åˆ†æ•¸ | 0-1 | Direct |

### ç‰¹å¾µæ¨™æº–åŒ–

```python
# Z-Score æ¨™æº–åŒ–
x_normalized = (x - mean) / std

# ç‰¹å¾µç¯„åœ: [-3, 3] (99.7% æ•¸æ“š)
```

---

## ğŸ¯ å¨è„…åˆ†é¡

### æ”¯æ´çš„å¨è„…é¡å‹

| ID | å¨è„…é¡å‹ | æè¿° | å…¸å‹ç‰¹å¾µ |
|----|---------|------|---------|
| 0 | DDoS | åˆ†æ•£å¼æ‹’çµ•æœå‹™ | é«˜ PPSï¼Œå¤šæº IPï¼ŒSYN æ´ªæ°´ |
| 1 | Port Scan | ç«¯å£æƒæ | å¤šç«¯å£é€£æ¥ï¼Œä½ Payload |
| 2 | Brute Force | æš´åŠ›ç ´è§£ | é«˜å¤±æ•—ç™»å…¥ï¼Œå–®ä¸€æº |
| 3 | SQL Injection | SQL æ³¨å…¥ | SQL é—œéµå­—ï¼Œç‰¹æ®Šå­—ç¬¦ |
| 4 | XSS | è·¨ç«™è…³æœ¬ | Script æ¨™ç±¤ï¼ŒJavaScript |
| 5 | Malware | æƒ¡æ„è»Ÿé«” | Shellcodeï¼Œé«˜ç†µå€¼ |
| 6 | Ransomware | å‹’ç´¢è»Ÿé«” | åŠ å¯†è¡Œç‚ºï¼Œæ–‡ä»¶ä¿®æ”¹ |
| 7 | Zero-Day | é›¶æ—¥æ¼æ´ | æœªçŸ¥æ¨¡å¼ï¼Œç•°å¸¸è¡Œç‚º |
| 8 | APT | é€²éšæŒçºŒæ€§å¨è„… | é•·æœŸæ½›ä¼ï¼Œå¤šéšæ®µæ”»æ“Š |
| 9 | Insider Threat | å…§éƒ¨å¨è„… | æ¬Šé™æ¿«ç”¨ï¼Œç•°å¸¸å­˜å– |

### å¨è„…ç­‰ç´šåˆ¤å®š

```python
if confidence >= 0.95:
    threat_level = "CRITICAL"  # ç«‹å³é˜»æ–·
elif confidence >= 0.85:
    threat_level = "HIGH"      # é˜»æ–·ä¸¦è¨˜éŒ„
elif confidence >= 0.75:
    threat_level = "MEDIUM"    # ç›£æ§ä¸¦å‘Šè­¦
else:
    threat_level = "LOW"       # è¨˜éŒ„è§€å¯Ÿ
```

---

## ğŸš€ API ä½¿ç”¨

### å¨è„…æª¢æ¸¬ API

#### ç«¯é»

```
POST /api/v1/ml/detect
```

#### è«‹æ±‚

```json
{
  "source_ip": "192.168.1.100",
  "target_ip": "10.0.0.1",
  "packet_size": 1200,
  "packets_per_second": 500,
  "bytes_per_second": 600000,
  "connection_count": 50,
  "unique_ips": 10,
  "is_tcp": true,
  "port_number": 80,
  "syn_count": 45,
  "payload_entropy": 0.8,
  "request_frequency": 50
}
```

#### éŸ¿æ‡‰

```json
{
  "status": "success",
  "detection": {
    "threat_id": "threat_20250114123045_1234",
    "threat_type": "ddos",
    "threat_level": "high",
    "confidence": 0.92,
    "source_ip": "192.168.1.100",
    "recommended_action": "é˜»æ–·ä¸¦è¨˜éŒ„",
    "timestamp": "2025-01-14T12:30:45.123456"
  }
}
```

### æ¨¡å‹ç‹€æ…‹ API

#### ç«¯é»

```
GET /api/v1/ml/model/status
```

#### éŸ¿æ‡‰

```json
{
  "model_id": "threat_detector_v1",
  "version": "1.0.0",
  "status": "active",
  "layers": 3,
  "parameters": 1312,
  "last_updated": "2025-01-14T12:00:00"
}
```

---

## ğŸ“ˆ æ€§èƒ½åˆ†æ

### æª¢æ¸¬æ€§èƒ½

| æŒ‡æ¨™ | è¨“ç·´é›† | é©—è­‰é›† | æ¸¬è©¦é›† |
|------|--------|--------|--------|
| æº–ç¢ºç‡ | 98.2% | 95.8% | 95.3% |
| ç²¾ç¢ºç‡ | 97.5% | 94.6% | 94.1% |
| å¬å›ç‡ | 96.8% | 93.2% | 92.7% |
| F1 åˆ†æ•¸ | 97.1% | 94.5% | 93.9% |

### å»¶é²åˆ†æ

| ç™¾åˆ†ä½ | å»¶é² |
|--------|------|
| P50 | 3ms |
| P90 | 7ms |
| P95 | 8ms |
| P99 | 9ms |
| P99.9 | 12ms |

### ååé‡æ¸¬è©¦

| ä¸¦ç™¼æ•¸ | ååé‡ (req/s) | å¹³å‡å»¶é² |
|--------|---------------|---------|
| 10 | 2,500 | 4ms |
| 50 | 9,800 | 5ms |
| 100 | 14,500 | 7ms |
| 500 | 18,200 | 27ms |

---

## ğŸ”§ é…ç½®èˆ‡èª¿å„ª

### ç’°å¢ƒè®Šæ•¸

```bash
ML_MODEL_PATH=/app/models          # æ¨¡å‹è·¯å¾‘
ML_CONFIDENCE_THRESHOLD=0.7        # ç½®ä¿¡åº¦é–¾å€¼
ML_BATCH_SIZE=32                   # æ‰¹æ¬¡å¤§å°
ML_WORKERS=4                       # å·¥ä½œåŸ·è¡Œç·’æ•¸
```

### æ¨¡å‹å„ªåŒ–

#### é‡åŒ–

```python
# INT8 é‡åŒ–å¯æ¸›å°‘ 4x è¨˜æ†¶é«”ä½¿ç”¨
# æ€§èƒ½å½±éŸ¿: < 1% æº–ç¢ºç‡ä¸‹é™
```

#### å‰ªæ

```python
# ç§»é™¤æ¬Šé‡ < 0.01 çš„é€£æ¥
# å¯æ¸›å°‘ 30% åƒæ•¸ï¼Œ2% æº–ç¢ºç‡ä¸‹é™
```

---

## ğŸ§ª è¨“ç·´èˆ‡é©—è­‰

### è¨“ç·´æ•¸æ“š

- **æ¨£æœ¬æ•¸**: 100,000+
- **å¨è„…æ¨£æœ¬**: 50,000
- **æ­£å¸¸æ¨£æœ¬**: 50,000
- **æ•¸æ“šä¾†æº**: CTU-13, CICIDS2017, è‡ªæ¡é›†

### è¨“ç·´éç¨‹

```python
# è¶…åƒæ•¸
learning_rate = 0.001
batch_size = 64
epochs = 100
optimizer = Adam

# è¨“ç·´æ™‚é–“: ~2å°æ™‚ (GPU)
```

### é©—è­‰ç­–ç•¥

- **äº¤å‰é©—è­‰**: 5-Fold
- **æ¸¬è©¦é›†**: 20% æ•¸æ“š
- **æ—©åœç­–ç•¥**: Patience=10

---

## ğŸ”— æ•´åˆ

### RabbitMQ æ•´åˆ

```python
# è¨‚é–±å°åŒ…äº‹ä»¶
await mq.subscribe(
    queue="ml_detection_queue",
    handler=process_and_detect
)

# ç™¼å¸ƒæª¢æ¸¬çµæœ
await mq.publish(
    exchange="pandora.events",
    routing_key="threat.ml_detected",
    message=json.dumps(detection)
)
```

### Prometheus æ•´åˆ

```python
# æŒ‡æ¨™
ml_detections = Counter('ml_threat_detections_total')
ml_latency = Histogram('ml_detection_latency_seconds')
ml_accuracy = Gauge('ml_model_accuracy')
```

---

## ğŸ“š åƒè€ƒè³‡æ–™

- [æ·±åº¦å­¸ç¿’åŸºç¤](https://www.deeplearningbook.org/)
- [ç¶²è·¯å®‰å…¨æ©Ÿå™¨å­¸ç¿’](https://github.com/jivoi/awesome-ml-for-cybersecurity)
- [CICIDS2017 æ•¸æ“šé›†](https://www.unb.ca/cic/datasets/ids-2017.html)

---

**ç¶­è­·è€…**: Pandora AI Team  
**æœ€å¾Œæ›´æ–°**: 2025-01-14  
**ç‰ˆæœ¬**: 3.2.0

