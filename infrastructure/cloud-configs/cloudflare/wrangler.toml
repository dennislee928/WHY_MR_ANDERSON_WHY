name = "security-platform-worker"
main = "dist/index.js"
compatibility_date = "2024-01-01"

# Account details (remove empty account_id)
workers_dev = true

# ========================================
# 注意：以下 bindings 已手動設定完成
# 請勿在 CI/CD 中覆蓋這些設定
# ========================================

# Routes (configure for production)
# routes = [
#   { pattern = "api.example.com/*", zone_name = "example.com" }
# ]

# Environment Variables
[env.production]
name = "security-platform-prod"

[env.staging]
name = "security-platform-staging"

# D1 Database binding - 已設定
[[d1_databases]]
binding = "DB"
database_name = "security_platform_db"
database_id = "security_platform_db" # 已設定

# KV Namespace bindings - 已設定
[[kv_namespaces]]
binding = "CACHE"
id = "cf-dapp-cache-prod" # 已設定
preview_id = ""

[[kv_namespaces]]
binding = "SESSIONS"
id = "cf-dapp-cache-prod" # 已設定
preview_id = ""

# Durable Objects - 已設定
[[durable_objects.bindings]]
name = "WEBSOCKET_MANAGER"
class_name = "WebSocketManager"
script_name = "web3-cloudflare-api_ApiContainer" # 已設定

[[migrations]]
tag = "v1"
new_classes = ["WebSocketManager"]

# Resource limits (within free tier)
[limits]
cpu_ms = 30000 # 30 seconds max per request

# Analytics
[observability]
enabled = true

# Build configuration
[build]
command = "npm run build"

